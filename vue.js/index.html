<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnHub - Professional Lesson Marketplace</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #000000;
            --primary-dark: #1a1a1a;
            --secondary-color: #f8f9fa;
            --accent-color: #333333;
            --warning-color: #666666;
            --danger-color: #000000;
            --text-primary: #000000;
            --text-secondary: #666666;
            --border-color: #e0e0e0;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --gradient-primary: linear-gradient(135deg, #000000 0%, #333333 100%);
            --gradient-secondary: linear-gradient(135deg, #f5f5f5 0%, #ffffff 100%);
            --gradient-accent: linear-gradient(135deg, #333333 0%, #666666 100%);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .main-container {
            background: white;
            border-radius: 20px;
            box-shadow: var(--shadow-xl);
            margin: 20px;
            min-height: calc(100vh - 40px);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        /* Navigation Styles */
        .navbar {
            background: var(--primary-color) !important;
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
        }

        .navbar-brand {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 1.5rem;
            color: white !important;
            text-decoration: none;
        }

        .nav-link {
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9) !important;
            transition: all 0.3s ease;
            border-radius: 8px;
            padding: 0.5rem 1rem !important;
            margin: 0 0.25rem;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
            color: white !important;
            transform: translateY(-1px);
        }

        .nav-link.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Card Styles */
        .lesson-card {
            border: none;
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            background: white;
            overflow: hidden;
            height: 100%;
        }

        .lesson-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .lesson-card .card-body {
            padding: 1.5rem;
        }

        .lesson-subject {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 1.25rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .lesson-location {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .lesson-price {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
        }

        .lesson-availability {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Button Styles */
        .btn {
            border-radius: 10px;
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            border-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .btn-success:hover {
            background: var(--primary-dark);
            border-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--text-secondary);
            color: white;
            border-color: var(--text-secondary);
        }

        .btn-danger {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
            border-color: var(--warning-color);
        }

        .btn-outline-primary {
            background: transparent;
            color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-outline-primary:hover {
            background: var(--primary-color);
            color: white;
        }

        /* Search and Filter Styles */
        .search-container {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow-md);
            margin-bottom: 2rem;
        }

        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid var(--border-color);
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(0, 0, 0, 0.25);
        }

        /* Alert Styles */
        .alert {
            border-radius: 12px;
            border: 1px solid var(--border-color);
            padding: 1rem 1.5rem;
        }

        .alert-success {
            background: #f8f9fa;
            color: var(--text-primary);
            border-color: var(--border-color);
        }

        .alert-warning {
            background: #f8f9fa;
            color: var(--text-primary);
            border-color: var(--border-color);
        }

        .alert-info {
            background: #f8f9fa;
            color: var(--text-primary);
            border-color: var(--border-color);
        }

        .alert-light {
            background: white;
            color: var(--text-primary);
            border-color: var(--border-color);
        }

        /* Badge Styles */
        .badge {
            border-radius: 8px;
            font-weight: 500;
            padding: 0.5rem 0.75rem;
        }

        /* Cart Styles */
        .cart-container {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .cart-header {
            background: var(--primary-color);
            color: white;
            padding: 1.5rem;
        }

        .cart-item {
            border-bottom: 1px solid var(--border-color);
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .cart-item:hover {
            background: #f8fafc;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-container {
                margin: 10px;
                border-radius: 16px;
            }
            
            .search-container {
                padding: 1rem;
            }
            
            .lesson-card .card-body {
                padding: 1rem;
            }
        }

        /* Subject Icons */
        .subject-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            border: 2px solid var(--border-color);
        }

        .subject-mathematics { background: var(--primary-color); color: white; }
        .subject-english { background: var(--accent-color); color: white; }
        .subject-science { background: var(--text-secondary); color: white; }
        .subject-history { background: var(--primary-dark); color: white; }
        .subject-art { background: var(--warning-color); color: white; }
        .subject-music { background: #f8f9fa; color: var(--text-primary); border-color: var(--border-color); }
        .subject-default { background: white; color: var(--text-primary); border-color: var(--border-color); }
    </style>
</head>
<body>
    <div id="app">
        <div class="main-container">
            <!-- Navigation -->
            <nav class="navbar navbar-expand-lg navbar-dark">
                <div class="container">
                    <a class="navbar-brand" href="#">
                        <i class="fas fa-graduation-cap me-2"></i>
                        LearnHub
                    </a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav me-auto">
                            <li class="nav-item">
                                <a class="nav-link" :class="{ active: currentView === 'lessons' }" 
                                   href="#" @click.prevent="currentView = 'lessons'">
                                    <i class="fas fa-book me-2"></i>
                                    Browse Lessons
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" 
                                   :class="{ 
                                       active: currentView === 'cart',
                                       disabled: cartItems.length === 0
                                   }" 
                                   :style="{ 
                                       cursor: cartItems.length === 0 ? 'not-allowed' : 'pointer',
                                       opacity: cartItems.length === 0 ? '0.5' : '1'
                                   }"
                                   href="#" 
                                   @click.prevent="toggleCartView()"
                                   :title="cartItems.length === 0 ? 'Add lessons to cart first' : 
                                           currentView === 'cart' ? 'Back to lessons' : 'View shopping cart'">
                                    <i class="fas me-2" :class="currentView === 'cart' ? 'fa-arrow-left' : 'fa-shopping-cart'"></i>
                                    <span v-if="currentView === 'cart'">Back to Lessons</span>
                                    <span v-else>Shopping Cart</span>
                                    <span v-if="cartItems.length === 0 && currentView !== 'cart'" class="badge bg-secondary ms-2">0</span>
                                    <span v-else-if="currentView !== 'cart'" class="badge bg-warning ms-2">{{ cartItems.length }}</span>
                                </a>
                            </li>
                        </ul>
                        <div class="navbar-nav">
                            <span class="nav-link text-light">
                                <i class="fas fa-user-circle me-2"></i>
                                Welcome to LearnHub
                            </span>
                        </div>
                    </div>
                </div>
            </nav>

            <div class="container-fluid p-4">
            <!-- Lessons View -->
            <div v-if="currentView === 'lessons'" class="fade-in-up">
                <!-- Hero Section -->
                <div class="text-center mb-5">
                    <h1 class="display-4 fw-bold mb-3" style="color: var(--text-primary);">
                        <i class="fas fa-star me-3" style="color: var(--text-primary);"></i>
                        Discover Amazing Lessons
                    </h1>
                    <p class="lead text-secondary">Find the perfect lesson for your learning journey</p>
                </div>

                <!-- Search and Filter Section -->
                <div class="search-container">
                    <div class="row align-items-center">
                        <div class="col-lg-8">
                            <div class="input-group mb-3">
                                <span class="input-group-text bg-light border-0">
                                    <i class="fas fa-search text-primary"></i>
                                </span>
                                <input 
                                    type="text" 
                                    class="form-control border-0 shadow-sm" 
                                    placeholder="Search by subject, location, price, or availability..." 
                                    v-model="searchQuery">
                                <button v-if="searchQuery" 
                                        class="btn btn-outline-danger" 
                                        type="button" 
                                        @click="clearSearch()"
                                        title="Clear search">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <span class="badge bg-light text-dark">üí° Try: "math"</span>
                                <span class="badge bg-light text-dark">"london"</span>
                                <span class="badge bg-light text-dark">"¬£25"</span>
                                <span class="badge bg-light text-dark">"5 spaces"</span>
                                <span class="badge bg-light text-dark">"english manchester"</span>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="d-flex gap-2">
                                <select class="form-select shadow-sm" v-model="sortBy">
                                    <option value="subject">üìö Subject</option>
                                    <option value="location">üìç Location</option>
                                    <option value="price">üí∞ Price</option>
                                    <option value="availability">üë• Spaces</option>
                                </select>
                                <button class="btn btn-outline-primary" @click="sortOrder = sortOrder === 'asc' ? 'desc' : 'asc'">
                                    <i class="fas" :class="sortOrder === 'asc' ? 'fa-sort-up' : 'fa-sort-down'"></i>
                                </button>
                            </div>
                        </div>
                        <div class="mt-2 d-flex justify-content-between align-items-center">
                            <button class="btn btn-sm" 
                                    :class="sortOrder === 'asc' ? 'btn-success' : 'btn-warning'"
                                    @click="sortOrder = sortOrder === 'asc' ? 'desc' : 'asc'">
                                <i class="fas me-2" :class="{
                                    'fa-sort-alpha-up': (sortBy === 'subject' || sortBy === 'location') && sortOrder === 'asc',
                                    'fa-sort-alpha-down': (sortBy === 'subject' || sortBy === 'location') && sortOrder === 'desc',
                                    'fa-sort-numeric-up': (sortBy === 'price' || sortBy === 'availability') && sortOrder === 'asc',
                                    'fa-sort-numeric-down': (sortBy === 'price' || sortBy === 'availability') && sortOrder === 'desc'
                                }"></i>
                                <strong>{{ sortOrder === 'asc' ? 'Ascending' : 'Descending' }}</strong>
                                <span class="badge bg-light text-dark ms-2">
                                    {{ sortOrder === 'asc' ? 'A‚ÜíZ' : 'Z‚ÜíA' }}
                                    <span v-if="sortBy === 'price' || sortBy === 'availability'">
                                        {{ sortOrder === 'asc' ? ' (Low‚ÜíHigh)' : ' (High‚ÜíLow)' }}
                                    </span>
                                </span>
                            </button>
                            <div class="text-end">
                                <small class="text-muted d-block">Currently sorting by:</small>
                                <strong class="text-primary">{{ 
                                    sortBy === 'subject' ? 'üìö Subject' : 
                                    sortBy === 'location' ? 'üìç Location' : 
                                    sortBy === 'price' ? 'üí∞ Price' : 
                                    sortBy === 'availability' ? 'üë• Available Spaces' : sortBy 
                                }}</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lessons Grid -->
                <div class="row g-4">
                    <div class="col-lg-4 col-md-6" v-for="lesson in filteredAndSortedLessons" :key="lesson._id">
                        <div class="lesson-card">
                            <div class="card-body">
                                <!-- Subject Icon -->
                                <div class="subject-icon mb-3" 
                                     :class="{
                                         'subject-mathematics': lesson.subject.toLowerCase().includes('math'),
                                         'subject-english': lesson.subject.toLowerCase().includes('english'),
                                         'subject-science': lesson.subject.toLowerCase().includes('science') || lesson.subject.toLowerCase().includes('chemistry') || lesson.subject.toLowerCase().includes('physics') || lesson.subject.toLowerCase().includes('biology'),
                                         'subject-history': lesson.subject.toLowerCase().includes('history'),
                                         'subject-art': lesson.subject.toLowerCase().includes('art'),
                                         'subject-music': lesson.subject.toLowerCase().includes('music'),
                                         'subject-default': !lesson.subject.toLowerCase().includes('math') && !lesson.subject.toLowerCase().includes('english') && !lesson.subject.toLowerCase().includes('science') && !lesson.subject.toLowerCase().includes('chemistry') && !lesson.subject.toLowerCase().includes('physics') && !lesson.subject.toLowerCase().includes('biology') && !lesson.subject.toLowerCase().includes('history') && !lesson.subject.toLowerCase().includes('art') && !lesson.subject.toLowerCase().includes('music')
                                     }">
                                    <i class="fas" :class="{
                                        'fa-calculator': lesson.subject.toLowerCase().includes('math'),
                                        'fa-book': lesson.subject.toLowerCase().includes('english'),
                                        'fa-flask': lesson.subject.toLowerCase().includes('science') || lesson.subject.toLowerCase().includes('chemistry'),
                                        'fa-atom': lesson.subject.toLowerCase().includes('physics'),
                                        'fa-microscope': lesson.subject.toLowerCase().includes('biology'),
                                        'fa-landmark': lesson.subject.toLowerCase().includes('history'),
                                        'fa-palette': lesson.subject.toLowerCase().includes('art'),
                                        'fa-music': lesson.subject.toLowerCase().includes('music'),
                                        'fa-graduation-cap': !lesson.subject.toLowerCase().includes('math') && !lesson.subject.toLowerCase().includes('english') && !lesson.subject.toLowerCase().includes('science') && !lesson.subject.toLowerCase().includes('chemistry') && !lesson.subject.toLowerCase().includes('physics') && !lesson.subject.toLowerCase().includes('biology') && !lesson.subject.toLowerCase().includes('history') && !lesson.subject.toLowerCase().includes('art') && !lesson.subject.toLowerCase().includes('music')
                                    }"></i>
                                </div>

                                <!-- Lesson Title -->
                                <h3 class="lesson-subject">{{ lesson.subject }}</h3>
                                
                                <!-- Location -->
                                <div class="lesson-location">
                                    <i class="fas fa-map-marker-alt me-2"></i>
                                    {{ lesson.location }}
                                </div>

                                <!-- Price and Availability -->
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div class="lesson-price">¬£{{ lesson.price }}</div>
                                    <div class="lesson-availability">
                                        <i class="fas fa-users me-1"></i>
                                        <span :class="{ 'text-danger': lesson.availability === 0, 'text-success': lesson.availability > 5, 'text-warning': lesson.availability > 0 && lesson.availability <= 5 }">
                                            {{ lesson.availability }} {{ lesson.availability === 1 ? 'space' : 'spaces' }}
                                        </span>
                                    </div>
                                </div>

                                <!-- Status Badge -->
                                <div class="mb-3">
                                    <span v-if="lesson.availability === 0" class="badge bg-danger">
                                        <i class="fas fa-times-circle me-1"></i>Sold Out
                                    </span>
                                    <span v-else-if="cartItems.find(item => item._id === lesson._id)" class="badge bg-success">
                                        <i class="fas fa-check-circle me-1"></i>In Cart
                                    </span>
                                    <span v-else-if="lesson.availability <= 3" class="badge bg-warning">
                                        <i class="fas fa-exclamation-triangle me-1"></i>Limited Spaces
                                    </span>
                                    <span v-else class="badge bg-primary">
                                        <i class="fas fa-star me-1"></i>Available
                                    </span>
                                </div>

                                <!-- Action Button -->
                                <button 
                                    class="btn w-100 fw-semibold" 
                                    :class="{
                                        'btn-secondary': lesson.availability === 0,
                                        'btn-success': cartItems.find(item => item._id === lesson._id),
                                        'btn-primary': lesson.availability > 0 && !cartItems.find(item => item._id === lesson._id)
                                    }"
                                    :disabled="lesson.availability === 0"
                                    @click="addToCart(lesson)"
                                    :title="lesson.availability === 0 ? 'No spaces available' : 
                                           cartItems.find(item => item._id === lesson._id) ? 'Add another space' : 
                                           `Add ${lesson.subject} to cart`">
                                    <i class="fas me-2" :class="{
                                        'fa-ban': lesson.availability === 0,
                                        'fa-plus': cartItems.find(item => item._id === lesson._id),
                                        'fa-shopping-cart': lesson.availability > 0 && !cartItems.find(item => item._id === lesson._id)
                                    }"></i>
                                    <span v-if="lesson.availability === 0">Sold Out</span>
                                    <span v-else-if="cartItems.find(item => item._id === lesson._id)">Add Another</span>
                                    <span v-else>Add to Cart</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div v-if="filteredAndSortedLessons.length === 0" class="alert alert-info text-center">
                    <i class="fas fa-info-circle me-2"></i>
                    No lessons found matching your search criteria.
                </div>

                <!-- Search and Sorting Information Display -->
                <div v-if="searchQuery || filteredAndSortedLessons.length > 0" class="alert alert-light border mb-4">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <!-- Search Results Info -->
                            <div v-if="searchQuery" class="mb-2">
                                <i class="fas fa-search me-2 text-info"></i>
                                <strong>Search Results:</strong>
                                Found {{ filteredAndSortedLessons.length }} lesson{{ filteredAndSortedLessons.length !== 1 ? 's' : '' }} 
                                matching "<span class="text-primary">{{ searchQuery }}</span>"
                                <span v-if="filteredAndSortedLessons.length === 0" class="text-danger">
                                    - Try different keywords or check spelling
                                </span>
                            </div>
                            
                            <!-- Sorting Info -->
                            <div v-if="filteredAndSortedLessons.length > 0">
                                <i class="fas fa-sort me-2 text-primary"></i>
                                <strong>{{ searchQuery ? 'Sorted' : 'Showing' }}:</strong> 
                                {{ filteredAndSortedLessons.length }} lesson{{ filteredAndSortedLessons.length !== 1 ? 's' : '' }} sorted by 
                                <span class="badge bg-primary">{{ 
                                    sortBy === 'subject' ? 'Subject' : 
                                    sortBy === 'location' ? 'Location' : 
                                    sortBy === 'price' ? 'Price' : 
                                    'Available Spaces' 
                                }}</span>
                                in 
                                <span class="badge" :class="sortOrder === 'asc' ? 'bg-success' : 'bg-warning'">
                                    {{ sortOrder === 'asc' ? 'Ascending' : 'Descending' }}
                                </span> 
                                order
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <small class="text-muted">
                                <i class="fas fa-lightbulb me-1"></i>
                                {{ searchQuery ? 'Clear search to see all lessons' : 'Click sort button to reverse order' }}
                            </small>
                        </div>
                    </div>
                </div>

                <!-- Button State Information -->
                <div class="alert alert-info mb-4" v-if="filteredAndSortedLessons.some(lesson => lesson.availability === 0)">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Button States:</strong>
                            <span class="badge bg-primary ms-2">üîµ Available</span>
                            <span class="badge bg-success ms-2">üü¢ In Cart</span>
                            <span class="badge bg-secondary ms-2">‚ö´ Sold Out (Disabled)</span>
                        </div>
                        <div class="col-md-4 text-end">
                            <small class="text-muted">
                                <i class="fas fa-ban me-1"></i>
                                Sold out buttons are disabled but visible
                            </small>
                        </div>
                    </div>
                </div>

                <!-- Cart Status Information -->
                <div class="alert mb-4" :class="cartItems.length === 0 ? 'alert-warning' : 'alert-success'">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <i class="fas me-2" :class="cartItems.length === 0 ? 'fa-shopping-cart' : 'fa-check-circle'"></i>
                            <strong v-if="cartItems.length === 0">Shopping Cart Status:</strong>
                            <strong v-else>Shopping Cart Ready:</strong>
                            <span v-if="cartItems.length === 0" class="text-muted ms-2">
                                Cart is empty - add lessons to enable cart toggle navigation
                            </span>
                            <span v-else class="ms-2">
                                {{ cartItems.length }} item{{ cartItems.length !== 1 ? 's' : '' }} in cart - 
                                <a href="#" @click.prevent="toggleCartView()" class="alert-link">
                                    {{ currentView === 'cart' ? 'Back to Lessons' : 'Toggle to Cart' }}
                                </a>
                            </span>
                        </div>
                        <div class="col-md-4 text-end">
                            <span v-if="cartItems.length === 0" class="badge bg-secondary">
                                <i class="fas fa-lock me-1"></i>Cart Disabled
                            </span>
                            <span v-else class="badge bg-success">
                                <i class="fas fa-exchange-alt me-1"></i>Toggle Enabled
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cart View -->
            <div v-if="currentView === 'cart'" class="fade-in-up">
                <!-- Cart Header -->
                <div class="cart-container mb-4">
                    <div class="cart-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h1 class="h2 mb-2">
                                    <i class="fas fa-shopping-cart me-3"></i>
                                    Your Shopping Cart
                                </h1>
                                <p class="mb-0 opacity-75">Review your selected lessons</p>
                            </div>
                            <div class="text-end">
                                <div class="h3 mb-1">{{ cartItems.length }}</div>
                                <small>{{ cartItems.length === 1 ? 'Item' : 'Items' }}</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div v-if="cartItems.length === 0" class="text-center py-5">
                    <div class="mb-4">
                        <i class="fas fa-shopping-cart text-muted" style="font-size: 4rem; opacity: 0.3;"></i>
                    </div>
                    <h3 class="text-muted mb-3">Your cart is empty</h3>
                    <p class="text-secondary mb-4">Discover amazing lessons and start your learning journey!</p>
                    <button class="btn btn-primary btn-lg" @click="toggleCartView()">
                        <i class="fas fa-search me-2"></i>
                        Browse Lessons
                    </button>
                </div>

                <div v-else>
                    <!-- Cart Items -->
                    <div class="cart-container mb-4">
                        <div class="p-4">
                            <h4 class="mb-4">
                                <i class="fas fa-list me-2 text-primary"></i>
                                Selected Lessons
                            </h4>
                            
                            <div v-for="item in cartItems" :key="item._id" class="cart-item">
                                <div class="row align-items-center">
                                    <!-- Subject Icon & Info -->
                                    <div class="col-md-6">
                                        <div class="d-flex align-items-center">
                                            <div class="subject-icon me-3" 
                                                 style="width: 60px; height: 60px; font-size: 1.5rem;"
                                                 :class="{
                                                     'subject-mathematics': item.subject.toLowerCase().includes('math'),
                                                     'subject-english': item.subject.toLowerCase().includes('english'),
                                                     'subject-science': item.subject.toLowerCase().includes('science') || item.subject.toLowerCase().includes('chemistry') || item.subject.toLowerCase().includes('physics') || item.subject.toLowerCase().includes('biology'),
                                                     'subject-history': item.subject.toLowerCase().includes('history'),
                                                     'subject-art': item.subject.toLowerCase().includes('art'),
                                                     'subject-music': item.subject.toLowerCase().includes('music'),
                                                     'subject-default': !item.subject.toLowerCase().includes('math') && !item.subject.toLowerCase().includes('english') && !item.subject.toLowerCase().includes('science') && !item.subject.toLowerCase().includes('chemistry') && !item.subject.toLowerCase().includes('physics') && !item.subject.toLowerCase().includes('biology') && !item.subject.toLowerCase().includes('history') && !item.subject.toLowerCase().includes('art') && !item.subject.toLowerCase().includes('music')
                                                 }">
                                                <i class="fas" :class="{
                                                    'fa-calculator': item.subject.toLowerCase().includes('math'),
                                                    'fa-book': item.subject.toLowerCase().includes('english'),
                                                    'fa-flask': item.subject.toLowerCase().includes('science') || item.subject.toLowerCase().includes('chemistry'),
                                                    'fa-atom': item.subject.toLowerCase().includes('physics'),
                                                    'fa-microscope': item.subject.toLowerCase().includes('biology'),
                                                    'fa-landmark': item.subject.toLowerCase().includes('history'),
                                                    'fa-palette': item.subject.toLowerCase().includes('art'),
                                                    'fa-music': item.subject.toLowerCase().includes('music'),
                                                    'fa-graduation-cap': !item.subject.toLowerCase().includes('math') && !item.subject.toLowerCase().includes('english') && !item.subject.toLowerCase().includes('science') && !item.subject.toLowerCase().includes('chemistry') && !item.subject.toLowerCase().includes('physics') && !item.subject.toLowerCase().includes('biology') && !item.subject.toLowerCase().includes('history') && !item.subject.toLowerCase().includes('art') && !item.subject.toLowerCase().includes('music')
                                                }"></i>
                                            </div>
                                            <div>
                                                <h5 class="mb-1">{{ item.subject }}</h5>
                                                <div class="text-muted mb-2">
                                                    <i class="fas fa-map-marker-alt me-1"></i>
                                                    {{ item.location }}
                                                </div>
                                                <div v-if="item.quantity > 1" class="badge bg-primary">
                                                    {{ item.quantity }} spaces
                                                </div>
                                            </div>
                                        </div>
                                    
                                    <!-- Price & Actions -->
                                    <div class="col-md-6">
                                        <div class="row align-items-center">
                                            <div class="col-md-4 text-center">
                                                <div class="text-muted small">Unit Price</div>
                                                <div class="fw-bold">¬£{{ item.price }}</div>
                                            </div>
                                            <div class="col-md-4 text-center">
                                                <div class="text-muted small">Subtotal</div>
                                                <div class="h5 text-success mb-0">¬£{{ (item.price * (item.quantity || 1)).toFixed(2) }}</div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="d-flex gap-2">
                                                    <button v-if="item.quantity > 1" 
                                                            class="btn btn-outline-warning btn-sm" 
                                                            @click="removeOneSpace(item._id)"
                                                            :title="`Remove 1 space of ${item.subject}`">
                                                        <i class="fas fa-minus"></i>
                                                    </button>
                                                    <button class="btn btn-outline-danger btn-sm" 
                                                            @click="removeFromCart(item._id)"
                                                            :title="`Remove ${item.subject} from cart`">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Cart Summary -->
                        <div class="cart-container">
                            <div class="p-4">
                                <div class="row">
                                    <div class="col-md-8">
                                        <h5 class="mb-3">
                                            <i class="fas fa-calculator me-2 text-primary"></i>
                                            Order Summary
                                        </h5>
                                        <div class="row text-center">
                                            <div class="col-4">
                                                <div class="border-end">
                                                    <div class="h4 text-primary mb-1">{{ cartItems.length }}</div>
                                                    <small class="text-muted">Lesson Types</small>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="border-end">
                                                    <div class="h4 text-info mb-1">{{ cartItems.reduce((total, item) => total + (item.quantity || 1), 0) }}</div>
                                                    <small class="text-muted">Total Spaces</small>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="h4 text-warning mb-1">¬£{{ cartItems.length > 0 ? (cartTotal / cartItems.reduce((total, item) => total + (item.quantity || 1), 0)).toFixed(2) : '0.00' }}</div>
                                                <small class="text-muted">Avg. per Space</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 text-center">
                                        <div class="bg-light rounded-3 p-3">
                                            <div class="text-muted mb-2">Total Amount</div>
                                            <div class="display-6 fw-bold text-success">¬£{{ cartTotal.toFixed(2) }}</div>
                                            <small class="text-muted">All lessons included</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Checkout Form -->
                    <div class="cart-container">
                        <div class="cart-header">
                            <h4 class="mb-0">
                                <i class="fas fa-credit-card me-3"></i>
                                Complete Your Order
                            </h4>
                        </div>
                        <div class="p-4">
                                    <form @submit.prevent="checkout">
                                        <div class="mb-3">
                                            <label for="name" class="form-label">
                                                <i class="fas fa-user me-2"></i>Full Name *
                                            </label>
                                            <input 
                                                type="text" 
                                                class="form-control" 
                                                :class="{ 
                                                    'is-valid': isValidName, 
                                                    'is-invalid': orderForm.name && !isValidName 
                                                }"
                                                id="name"
                                                v-model="orderForm.name" 
                                                placeholder="Letters only (e.g., JohnSmith)"
                                                required>
                                            <div class="invalid-feedback">
                                                Name must be letters only (no spaces, numbers, or special characters). Minimum 2 characters.
                                            </div>
                                            <div class="valid-feedback">
                                                Perfect! Letters only name accepted.
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="phone" class="form-label">
                                                <i class="fas fa-phone me-2"></i>Phone Number *
                                            </label>
                                            <input 
                                                type="tel" 
                                                class="form-control" 
                                                :class="{ 
                                                    'is-valid': isValidPhone, 
                                                    'is-invalid': orderForm.phone && !isValidPhone 
                                                }"
                                                id="phone"
                                                v-model="orderForm.phone" 
                                                placeholder="Numbers only (e.g., 1234567890)"
                                                required>
                                            <div class="invalid-feedback">
                                                Phone must be numbers only (no letters, spaces, or special characters). Minimum 10 digits.
                                            </div>
                                            <div class="valid-feedback">
                                                Perfect! Numbers only phone accepted.
                                            </div>
                                        </div>
                                        
                                        <!-- Form Validation Status -->
                                        <div class="alert mb-3" :class="isFormValid ? 'alert-success' : 'alert-warning'">
                                            <i class="fas me-2" :class="isFormValid ? 'fa-check-circle' : 'fa-exclamation-triangle'"></i>
                                            <strong v-if="isFormValid">Ready to checkout!</strong>
                                            <strong v-else>Please complete the form:</strong>
                                            <ul class="mb-0 mt-2" v-if="!isFormValid">
                                                <li v-if="!isValidName">Name: Letters only, minimum 2 characters</li>
                                                <li v-if="!isValidPhone">Phone: Numbers only, minimum 10 digits</li>
                                            </ul>
                                        </div>
                                        
                                        <button type="submit" 
                                                class="btn w-100" 
                                                :class="isFormValid ? 'btn-success' : 'btn-secondary'"
                                                :disabled="!isFormValid"
                                                :title="isFormValid ? 'Place your order' : 'Please complete all required fields'">
                                            <i class="fas me-2" :class="isFormValid ? 'fa-check' : 'fa-lock'"></i>
                                            <span v-if="isFormValid">Place Order (¬£{{ cartTotal.toFixed(2) }})</span>
                                            <span v-else>Complete Form to Place Order</span>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            </div> <!-- Close container-fluid -->
        </div> <!-- Close main-container -->
    </div> <!-- Close #app -->

    <!-- Vue.js 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Vue.js Application Code -->
    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    currentView: 'lessons',
                    lessons: [],
                    cartItems: [],
                    searchQuery: '',
                    sortBy: 'subject',
                    sortOrder: 'asc',
                    orderForm: {
                        name: '',
                        phone: ''
                    },
                    apiBaseUrl: 'https://your-api-url.com/api' // Update this with your deployed API URL
                }
            },
            computed: {
                filteredAndSortedLessons() {
                    let filtered = this.lessons;
                    
                    // Full-text search across all lesson attributes
                    if (this.searchQuery) {
                        const query = this.searchQuery.toLowerCase().trim();
                        filtered = filtered.filter(lesson => {
                            // Convert all searchable attributes to lowercase strings
                            const subject = lesson.subject.toLowerCase();
                            const location = lesson.location.toLowerCase();
                            const price = lesson.price.toString().toLowerCase();
                            const availability = lesson.availability.toString().toLowerCase();
                            
                            // Create a combined searchable text string
                            const searchableText = `${subject} ${location} ${price} ${availability}`;
                            
                            // Support both single term and multi-term search
                            const searchTerms = query.split(' ').filter(term => term.length > 0);
                            
                            // Check if ALL search terms are found (AND logic)
                            const allTermsFound = searchTerms.every(term => 
                                subject.includes(term) ||
                                location.includes(term) ||
                                price.includes(term) ||
                                availability.includes(term) ||
                                searchableText.includes(term)
                            );
                            
                            // Log search details for debugging
                            if (allTermsFound) {
                                console.log(`üîç Search match found: "${lesson.subject}" for query "${query}"`);
                            }
                            
                            return allTermsFound;
                        });
                    }
                    
                    // Sort lessons by selected attribute
                    filtered.sort((a, b) => {
                        let aValue = a[this.sortBy];
                        let bValue = b[this.sortBy];
                        
                        // Handle different data types for sorting
                        if (this.sortBy === 'price' || this.sortBy === 'availability') {
                            // Numeric sorting for price and availability
                            aValue = Number(aValue);
                            bValue = Number(bValue);
                        } else {
                            // String sorting for subject and location (case-insensitive)
                            aValue = String(aValue).toLowerCase();
                            bValue = String(bValue).toLowerCase();
                        }
                        
                        // Apply sort order (ascending or descending)
                        if (this.sortOrder === 'asc') {
                            return aValue < bValue ? -1 : aValue > bValue ? 1 : 0;
                        } else {
                            return aValue > bValue ? -1 : aValue < bValue ? 1 : 0;
                        }
                    });
                    
                    return filtered;
                },
                cartTotal() {
                    return this.cartItems.reduce((total, item) => total + (item.price * (item.quantity || 1)), 0);
                },
                
                // Form validation computed properties using JavaScript regular expressions
                isValidName() {
                    // Name must be LETTERS ONLY (no spaces, numbers, or special characters)
                    const nameRegex = /^[a-zA-Z]{2,}$/;
                    const isValid = this.orderForm.name && nameRegex.test(this.orderForm.name.trim());
                    
                    // Debug logging for validation
                    if (this.orderForm.name) {
                        console.log(`Name validation: "${this.orderForm.name}" ‚Üí ${isValid ? '‚úÖ Valid' : '‚ùå Invalid'} (letters only)`);
                    }
                    
                    return isValid;
                },
                
                isValidPhone() {
                    // Phone must be NUMBERS ONLY (no letters, spaces, or special characters)
                    const phoneRegex = /^[0-9]{10,}$/;
                    const isValid = this.orderForm.phone && phoneRegex.test(this.orderForm.phone.trim());
                    
                    // Debug logging for validation
                    if (this.orderForm.phone) {
                        console.log(`Phone validation: "${this.orderForm.phone}" ‚Üí ${isValid ? '‚úÖ Valid' : '‚ùå Invalid'} (numbers only, 10+ digits)`);
                    }
                    
                    return isValid;
                },
                
                isFormValid() {
                    return this.isValidName && this.isValidPhone;
                },
                
                // Search statistics for debugging and analytics
                searchStats() {
                    if (!this.searchQuery) {
                        return {
                            totalLessons: this.lessons.length,
                            searchActive: false,
                            matchedLessons: this.lessons.length,
                            searchTerms: []
                        };
                    }
                    
                    const searchTerms = this.searchQuery.toLowerCase().trim().split(' ').filter(term => term.length > 0);
                    return {
                        totalLessons: this.lessons.length,
                        searchActive: true,
                        matchedLessons: this.filteredAndSortedLessons.length,
                        searchTerms: searchTerms,
                        matchPercentage: this.lessons.length > 0 ? 
                            ((this.filteredAndSortedLessons.length / this.lessons.length) * 100).toFixed(1) : 0
                    };
                }
            },
            methods: {
                async fetchLessons() {
                    try {
                        const response = await fetch(`${this.apiBaseUrl}/lessons`);
                        if (response.ok) {
                            this.lessons = await response.json();
                        } else {
                            console.error('Failed to fetch lessons');
                            // Fallback to mock data for development
                            this.loadMockData();
                        }
                    } catch (error) {
                        console.error('Error fetching lessons:', error);
                        // Fallback to mock data for development
                        this.loadMockData();
                    }
                },
                
                
                addToCart(lesson) {
                    // Prevent adding if no spaces available (double-check safety)
                    if (lesson.availability <= 0) {
                        console.warn(`Cannot add ${lesson.subject} to cart: No spaces available (${lesson.availability})`);
                        return; // Exit early, do nothing
                    }
                    
                    // Only proceed if spaces are available
                    if (lesson.availability > 0) {
                        // Check if this is the first item being added to cart
                        const wasCartEmpty = this.cartItems.length === 0;
                        
                        // Check if lesson is already in cart
                        const existingItem = this.cartItems.find(item => item._id === lesson._id);
                        if (!existingItem) {
                            // Add new lesson to cart with quantity 1
                            this.cartItems.push({ ...lesson, quantity: 1 });
                        } else {
                            // Increase quantity if already in cart
                            existingItem.quantity++;
                        }
                        
                        // Show special message when cart becomes enabled for the first time
                        if (wasCartEmpty && this.cartItems.length > 0) {
                            console.log('üõí Shopping Cart is now ENABLED! You can access the cart navigation.');
                        }
                        
                        // Decrease availability in the lessons array by 1
                        const lessonIndex = this.lessons.findIndex(l => l._id === lesson._id);
                        if (lessonIndex !== -1) {
                            this.lessons[lessonIndex].availability--;
                            
                            // Log the action with updated availability
                            const newAvailability = this.lessons[lessonIndex].availability;
                            console.log(`‚úÖ Added 1 space of ${lesson.subject} to cart. ${newAvailability} spaces remaining.`);
                            
                            // Special message when lesson becomes sold out
                            if (newAvailability === 0) {
                                console.log(`üö´ ${lesson.subject} is now SOLD OUT - button will be disabled`);
                            }
                        }
                    }
                },
                
                removeFromCart(lessonId) {
                    const itemIndex = this.cartItems.findIndex(item => item._id === lessonId);
                    if (itemIndex !== -1) {
                        const cartItem = this.cartItems[itemIndex];
                        const quantityToRestore = cartItem.quantity || 1;
                        
                        // Increase availability back in lessons array by the quantity
                        const lessonIndex = this.lessons.findIndex(l => l._id === lessonId);
                        if (lessonIndex !== -1) {
                            const oldAvailability = this.lessons[lessonIndex].availability;
                            this.lessons[lessonIndex].availability += quantityToRestore;
                            const newAvailability = this.lessons[lessonIndex].availability;
                            
                            console.log(`üîÑ Removed ${cartItem.subject} from cart:`);
                            console.log(`   - Quantity removed: ${quantityToRestore} space${quantityToRestore > 1 ? 's' : ''}`);
                            console.log(`   - Availability restored: ${oldAvailability} ‚Üí ${newAvailability}`);
                            console.log(`   - ${cartItem.subject} is now available again in lesson list`);
                        }
                        
                        // Remove entire item from cart
                        this.cartItems.splice(itemIndex, 1);
                        
                        // Show user feedback
                        console.log(`‚úÖ ${cartItem.subject} successfully removed from cart and restored to lesson list`);
                        
                        // If cart becomes empty, provide guidance
                        if (this.cartItems.length === 0) {
                            console.log('üõí Cart is now empty - you can browse lessons to add more items');
                        }
                    }
                },
                
                removeOneSpace(lessonId) {
                    const itemIndex = this.cartItems.findIndex(item => item._id === lessonId);
                    if (itemIndex !== -1) {
                        const cartItem = this.cartItems[itemIndex];
                        
                        // Increase availability back in lessons array by 1
                        const lessonIndex = this.lessons.findIndex(l => l._id === lessonId);
                        if (lessonIndex !== -1) {
                            this.lessons[lessonIndex].availability += 1;
                            console.log(`‚ûñ Removed 1 space of ${cartItem.subject} from cart`);
                            console.log(`   - Availability increased: ${this.lessons[lessonIndex].availability - 1} ‚Üí ${this.lessons[lessonIndex].availability}`);
                        }
                        
                        // Decrease quantity by 1
                        cartItem.quantity -= 1;
                        
                        // If quantity becomes 0, remove the item entirely
                        if (cartItem.quantity <= 0) {
                            this.cartItems.splice(itemIndex, 1);
                            console.log(`‚úÖ ${cartItem.subject} completely removed from cart (quantity reached 0)`);
                        } else {
                            console.log(`‚úÖ ${cartItem.subject} quantity reduced to ${cartItem.quantity}`);
                        }
                    }
                },
                
                toggleCartView() {
                    // Only allow toggle if cart has items (prevent access to empty cart)
                    if (this.cartItems.length === 0) {
                        console.warn('Cannot access cart: Cart is empty. Add lessons first.');
                        return;
                    }
                    
                    // Toggle between lessons and cart views
                    if (this.currentView === 'cart') {
                        this.currentView = 'lessons';
                        console.log('üìö Switched back to lessons view');
                    } else {
                        this.currentView = 'cart';
                        console.log('üõí Switched to cart view');
                    }
                },
                
                async checkout() {
                    // Validate cart is not empty
                    if (this.cartItems.length === 0) {
                        console.warn('Cannot checkout: Cart is empty');
                        return;
                    }
                    
                    // Validate form before proceeding
                    if (!this.isFormValid) {
                        console.warn('Cannot checkout: Form validation failed');
                        alert('Please complete all required fields with valid information before placing your order.');
                        return;
                    }
                    
                    console.log('‚úÖ Form validation passed - proceeding with checkout');
                    
                    const orderData = {
                        name: this.orderForm.name,
                        phone: this.orderForm.phone,
                        lessons: this.cartItems.map(item => ({
                            _id: item._id,
                            subject: item.subject,
                            location: item.location,
                            price: item.price
                        })),
                        total: this.cartTotal
                    };
                    
                    try {
                        const response = await fetch(`${this.apiBaseUrl}/orders`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(orderData)
                        });
                        
                        if (response.ok) {
                            const newOrder = await response.json();
                            
                            // Create detailed confirmation message
                            const orderSummary = this.cartItems.map(item => 
                                `‚Ä¢ ${item.subject} (${item.quantity || 1}x) - ${item.location} - ¬£${(item.price * (item.quantity || 1)).toFixed(2)}`
                            ).join('\n');
                            
                            const confirmationMessage = `üéâ ORDER CONFIRMED! üéâ

üìã Order Details:
Customer: ${orderData.name}
Phone: ${orderData.phone}
Order Total: ¬£${orderData.total.toFixed(2)}

üìö Lessons Ordered:
${orderSummary}

‚úÖ Your order has been successfully submitted!
üìß You will receive a confirmation shortly.
üì± We may contact you at ${orderData.phone} if needed.

Thank you for choosing our lesson service!`;

                            // Display confirmation message
                            alert(confirmationMessage);
                            console.log('üéâ Order successfully placed:', newOrder);
                            
                            // Update lesson availability on server
                            for (const item of this.cartItems) {
                                await this.updateLessonAvailability(item._id, -1);
                            }
                            
                            // Clear cart and form
                            this.cartItems = [];
                            this.orderForm.name = '';
                            this.orderForm.phone = '';
                            
                            // Navigate back to lessons view
                            this.currentView = 'lessons';
                        } else {
                            const errorMessage = `‚ùå ORDER FAILED

Sorry, we couldn't process your order at this time.

Please check:
‚Ä¢ Your internet connection
‚Ä¢ Try again in a few moments
‚Ä¢ Contact support if the problem persists

Your cart items have been preserved.`;
                            
                            alert(errorMessage);
                            console.error('Order submission failed:', response.status, response.statusText);
                        }
                    } catch (error) {
                        console.error('Error placing order:', error);
                        
                        const networkErrorMessage = `üåê CONNECTION ERROR

Unable to connect to our servers.

Possible causes:
‚Ä¢ Network connection issues
‚Ä¢ Server temporarily unavailable
‚Ä¢ Firewall or security software blocking the request

Please:
‚Ä¢ Check your internet connection
‚Ä¢ Try again in a few minutes
‚Ä¢ Contact support if the issue persists

Your cart has been preserved.`;
                        
                        alert(networkErrorMessage);
                    }
                },
                
                // Method to highlight search terms in text
                highlightSearchTerms(text, searchQuery) {
                    if (!searchQuery || !text) return text;
                    
                    const terms = searchQuery.toLowerCase().trim().split(' ').filter(term => term.length > 0);
                    let highlightedText = text.toString();
                    
                    terms.forEach(term => {
                        const regex = new RegExp(`(${term})`, 'gi');
                        highlightedText = highlightedText.replace(regex, '<mark class="bg-warning">$1</mark>');
                    });
                    
                    return highlightedText;
                },
                
                // Method to clear search and show all lessons
                clearSearch() {
                    this.searchQuery = '';
                    console.log('üîç Search cleared - showing all lessons');
                },
                
                async updateLessonAvailability(lessonId, change) {
                    try {
                        await fetch(`${this.apiBaseUrl}/lessons/${lessonId}/availability`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ change })
                        });
                    } catch (error) {
                        console.error('Error updating lesson availability:', error);
                    }
                },
                
                loadMockData() {
                    // Mock data for development/testing - 10 lessons with at least 5 spaces each
                    this.lessons = [
                        {
                            _id: '1',
                            subject: 'Mathematics',
                            location: 'London',
                            price: 25,
                            availability: 5
                        },
                        {
                            _id: '2',
                            subject: 'English',
                            location: 'Manchester',
                            price: 20,
                            availability: 5
                        },
                        {
                            _id: '3',
                            subject: 'Science',
                            location: 'Birmingham',
                            price: 30,
                            availability: 8
                        },
                        {
                            _id: '4',
                            subject: 'History',
                            location: 'Liverpool',
                            price: 22,
                            availability: 5
                        },
                        {
                            _id: '5',
                            subject: 'Geography',
                            location: 'Leeds',
                            price: 18,
                            availability: 6
                        },
                        {
                            _id: '6',
                            subject: 'Art',
                            location: 'Bristol',
                            price: 28,
                            availability: 5
                        },
                        {
                            _id: '7',
                            subject: 'Music',
                            location: 'Edinburgh',
                            price: 35,
                            availability: 5
                        },
                        {
                            _id: '8',
                            subject: 'Physics',
                            location: 'Glasgow',
                            price: 32,
                            availability: 7
                        },
                        {
                            _id: '9',
                            subject: 'Chemistry',
                            location: 'Cardiff',
                            price: 29,
                            availability: 5
                        },
                        {
                            _id: '10',
                            subject: 'Biology',
                            location: 'Belfast',
                            price: 27,
                            availability: 5
                        }
                    ];
                }
            },
            
            mounted() {
                this.fetchLessons();
            }
        }).mount('#app');
    </script>
</body>
</html>